% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fns.R
\name{plot_subject}
\alias{plot_subject}
\title{Visualize MRI slices from structured NIfTI inputs}
\usage{
plot_subject(
  input,
  type = "raw",
  space = "regMNI",
  sequences = "t1ce",
  planes = c("sag", "axi", "cor"),
  slices = NULL,
  masks = NULL,
  mask_alpha = 0.25,
  mask_clrp_adjust = NULL,
  mask_linesize = 1,
  mask_main = 1,
  grid = NULL,
  grid_x = NULL,
  grid_y = NULL,
  grid_alpha = 0.25,
  grid_color = "white",
  grid_linesize = 0.25,
  slice_num = TRUE,
  slice_num_fct = 0.975,
  slice_num_size = 2.5,
  guide = "none",
  offset_dist = 0,
  offset_dir = "left",
  mni_path = NULL,
  mni_dir = "/Users/heilandr/lab/data/mri/MNI_templates/MNI152",
  layers_misc = list(),
  ratio = 1,
  cols = NULL,
  rows = NULL,
  ncol = NULL,
  nrow = NULL,
  axes_rm = FALSE,
  animate = NULL
)
}
\arguments{
\item{input}{A path to a directory containing NIfTI files named according to the \verb{<type>_<sequence>_<space>.nii.gz} convention,
a path to a single NIfTI file, or a NIfTI object directly.}

\item{type}{A string specifying the file prefix (e.g., \code{"brainm"} for skull-stripped images). Default is \code{"brainm"}.}

\item{space}{A string specifying the spatial suffix (e.g., \code{"regRef"}, \code{"regMNI"}, \code{"orig"}). Default is \code{"fsMNI"}.}

\item{sequences}{Character vector of MRI sequences to load (e.g., \code{"t1ce"}, \code{"flair"}). Can also include \code{"mni"} to overlay a reference.}

\item{planes}{Character vector specifying which anatomical planes to plot: any combination of \code{"sag"}, \code{"axi"}, \code{"cor"}.}

\item{slices}{A numeric vector of slice indices (or fractions < 1 to indicate percent of axis) to display. If \code{NULL} and a mask is given,
slices are chosen to best capture the mask extent.}

\item{mask_alpha}{Alpha transparency of the mask overlay.}

\item{mask_linesize}{Line width of the mask outline.}

\item{grid}{Optional grid to overlay (either vector of values or fraction of image size).}

\item{grid_x, grid_y}{Vectors of x/y-positions for gridlines (overrides \code{grid} if set separately).}

\item{grid_alpha}{Alpha transparency of the grid lines.}

\item{grid_color}{Color of grid lines.}

\item{grid_linesize}{Line width of grid lines.}

\item{slice_num}{Logical; if \code{TRUE}, displays slice numbers as text overlay.}

\item{slice_num_fct}{Numeric vector (length 1 or 2) for horizontal and vertical placement of slice numbers as fraction of image size.}

\item{slice_num_size}{Font size of the slice number labels.}

\item{guide}{Type of fill legend guide to use (default \code{"none"}).}

\item{cols, rows}{Column and row variables for faceting.}

\item{ncol, nrow}{Numeric; number of columns and rows for facet layout (if applicable).}

\item{mask}{Optional string indicating which mask to load (e.g., \code{"tumor"}). The function expects a file named \verb{mask_<mask>_<space>.nii.gz}.}

\item{mask_color}{Fill and border color of the mask.}
}
\value{
A \code{ggplot} object with the requested slice visualization.
}
\description{
Visualizes single or multiple slices from MRI sequences based on a structured directory and file naming convention.
Files are expected to follow the format \verb{<type>_<sequence>_<space>.nii.gz}, where:
\itemize{
\item \code{type}: denotes the kind of image (e.g., \code{"brainm"} for skull-stripped, \code{"raw"} for original, \code{"mask"} for binary masks).
\item \code{sequence}: the MRI modality (e.g., \code{"t1"}, \code{"t1ce"}, \code{"t2"}, \code{"flair"}).
\item \code{space}: the spatial context (e.g., \code{"orig"} for unregistered space, \code{"regRef"} for session-specific reference-registered space, \code{"regMNI"} for mni-registered space).
}

Each image is read, sliced, and displayed based on instructions passed through the \code{planes} and \code{slices} arguments.
}
\details{
If \code{input} is a directory, the function searches for files matching the naming scheme \verb{<type>_<sequence>_<space>.nii.gz} inside the \verb{nifti/} subdirectory.
If a mask is provided, and \code{slices} is \code{NULL}, the function identifies the most informative slices based on mask voxel density per plane.

Slices are extracted using custom axis conversion and projected as 2D images with optional overlays for masks and grid lines.

The function supports multi-sequence and multi-plane faceting. To avoid overplotting, it restricts combinations of more than two varying dimensions (\code{plane}, \code{slice}, \code{sequence}).
}
\examples{
\dontrun{
# Plot one axial slice from T1-CE image, with tumor mask overlay
plot_subject(input = "sub-001/",
             type = "brainm",
             space = "regRef",
             sequences = "t1ce",
             mask = "tumor",
             planes = "axi",
             slices = 128)

# Plot 3 anatomical planes through the most informative tumor slices
plot_subject(input = "sub-002/",
             type = "brainm",
             space = "regRef",
             sequences = "t1ce",
             mask = "tumor")
}

}
